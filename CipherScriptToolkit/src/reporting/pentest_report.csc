// Expose scope because this generates files
expose scope generate_pentest_report(scan_results: clean str[], output_path: clean str) -> signal {

    // Start with an empty report
    probe report: clean str = "=== Pentest Report ===\n"

    // Append each scan result
    sweep r in scan_results {
        report += "- " + r + "\n"
    }

    // Include timestamp
    report += "Generated at: " + fmt.timestamp() + "\n"

    // Write report to disk
    probe result: signal = file.write(output_path, report)
    intercept result == signal::alert {
        log("[ERROR] Failed to write pentest report")
        return signal::fail
    }

    log("[INFO] Pentest report generated successfully: " + output_path)
    return signal::ok
}


// Module-level rate limit in milliseconds
implant RATE_LIMIT_MS: int = 500

// Expose scope for network operations
expose scope brute_force_dirs(host: clean str, paths: str[]) -> signal {

    // Sweep through each path in the wordlist
    sweep p in paths {

        // Check if endpoint exists
        scan net.http.get(host + "/" + p) == signal::ok {
            log("[OPEN] Found endpoint: " + p)  // Log found endpoint
        } pivot { 
            evade  // Skip to next path if not found
        }

        // Sleep to respect rate limit
        persist sleep(RATE_LIMIT_MS)
    }

    // Return success after all paths checked
    return signal::ok
}


// Expose scope for network operations
expose scope audit_http_headers(url: clean str) -> signal {

    // Fetch HTTP headers (untrusted string)
    probe headers: untrusted str = net.http.get(url)
    
    // Check HSTS header presence
    scan headers contains "Strict-Transport-Security" == false {
        log("[WARNING] HSTS missing for " + url)
    }

    // Check Content-Security-Policy header
    scan headers contains "Content-Security-Policy" == false {
        log("[WARNING] CSP missing for " + url)
    }

    // Check X-Frame-Options header
    scan headers contains "X-Frame-Options" == false {
        log("[WARNING] X-Frame-Options missing for " + url)
    }

    // Audit log completion
    log("[INFO] HTTP header audit complete for " + url)

    // Return ok signal
    return signal::ok
}


// Implant variables to store module-level common credentials
implant COMMON_CREDS: str[] = ["admin:admin", "root:root", "user:password"]

// Expose scope because we are connecting to network services
expose scope test_default_creds(host: clean str, port: int) -> signal {

    // Loop over each username:password combo
    sweep cred in COMMON_CREDS {

        // Split string into username and password
        probe user, pass = split(cred, ":")

        // Attempt TCP connection to host:port
        scan net.connect(host, port) == signal::ok {

            // Attempt authentication with credentials
            scan auth_attempt(host, port, user, pass) == signal::ok {
                log("[ALERT] Default creds found: " + cred)  // Log alert
                return signal::alert  // Stop after first valid credential
            }
        } pivot { 
            evade  // Skip to next credential if connection fails
        }
    }

    // Return ok if no credentials worked
    return signal::ok
}

